<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Add Product</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-200 flex justify-center items-center min-h-screen">

<div class="bg-white p-6 rounded shadow-md w-96">
  <h2 class="text-xl font-bold mb-4 text-center">Add Product</h2>

  <input id="name" class="border w-full p-2 mb-2" placeholder="Product Name">

  <input id="category" class="border w-full p-2 mb-2" placeholder="Category">

  <input id="price" class="border w-full p-2 mb-2" type="number" placeholder="Price">

  <input id="stock" class="border w-full p-2 mb-2" type="number" placeholder="Stock Quantity">

  <input id="unit" class="border w-full p-2 mb-4" placeholder="Unit (pcs, box, bottle etc.)">

  <button onclick="saveProduct()"
    class="bg-blue-600 text-white w-full p-2 rounded-lg font-semibold hover:bg-blue-700 transition">
    Save Product
  </button>

  <p id="msg" class="mt-3 text-center font-semibold"></p>

  <button onclick="goBack()"
    class="bg-gray-700 text-white w-full mt-4 p-2 rounded hover:bg-gray-800 transition">
    Back to Products
  </button>
</div>

<script>
function getToken() {
  const token = localStorage.getItem("token");
  if (!token) window.location.href = "index.html"; 
  return token;
}

async function saveProduct() {
  const name = document.getElementById("name").value;
  const category = document.getElementById("category").value;
  const price = document.getElementById("price").value;
  const stock = document.getElementById("stock").value;
  const unit = document.getElementById("unit").value;

  if (!name || !category || !price || !stock || !unit) {
    msg.innerText = "⚠️ Please enter all values";
    msg.style.color = "red";
    return;
  }

  const res = await fetch("/api/products", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + getToken()
    },
    body: JSON.stringify({ name, category, price, stock, unit })
  });

  const data = await res.json();
  msg.innerText = data.message;
  msg.style.color = "green";

  document.getElementById("name").value = "";
  document.getElementById("category").value = "";
  document.getElementById("price").value = "";
  document.getElementById("stock").value = "";
  document.getElementById("unit").value = "";
}

function goBack() {
  window.location.href = "view-products.html";
}
</script>

</body>
</html>
